<!DOCTYPE html>
<html>
	<head>
		<link type="text/css" rel="stylesheet" href="{{ url_for('static', filename='styles/styles.css') }}">
	</head>

	<body>

		<h1>Welcome, {{ username }} </h1>

		<h2> View All My Flights </h2>

		<table>

			<tr>
				<td> Flight Number </td>
				<td> Ticket ID </td>
				<td> Airline Name </td>
				<td> Airplane ID </td>
				<td> Departure Airport </td>
				<td> Departure Date </td>
				<td> Departure Time </td>
				<td> Arrival Airport </td>
				<td> Arrival Date </td>
				<td> Arrival Time </td>
			</tr>

			{% for flight in all_flights %}

				{% for flight_info in all_flights_info %}

					{% if flight['flight_num'] == flight_info['flight_num'] %}

					<tr>
						<td> {{ flight['flight_num'] }} </td>
						<td> {{ flight['ticket_ID'] }} </td>
						<td> {{ flight_info['airline_name'] }} </td>
						<td> {{ flight_info['airplane_ID'] }} </td>
						<td> {{ flight_info['departure_airport'] }} </td>
						<td> {{ flight_info['departure_date'] }} </td>
						<td> {{ flight_info['departure_time'] }} </td>
						<td> {{ flight_info['arrival_airport'] }} </td>
						<td> {{ flight_info['arrival_date'] }} </td>
						<td> {{ flight_info['arrival_time'] }} </td>
					<tr>

					{% endif %}

				{% endfor %}
				
			{% endfor %}

		</table>



		<h2> View My Past Flights </h2>
	
		<table>

			<tr>
				<td> Flight Number </td>
				<td> Ticket ID </td>
				<td> Airline Name </td>
				<td> Airplane ID </td>
				<td> Departure Airport </td>
				<td> Departure Date </td>
				<td> Departure Time </td>
				<td> Arrival Airport </td>
				<td> Arrival Date </td>
				<td> Arrival Time </td>
				<td> Rate and Review </td>

			</tr>


			{% for flight in all_flights %}

				{% for flight_info in past_flights_info %}

					{% if flight['flight_num'] == flight_info['flight_num'] %}

					<tr>
						<td> {{ flight['flight_num'] }} </td>
						<td> {{ flight['ticket_ID'] }} </td>
						<td> {{ flight_info['airline_name'] }} </td>
						<td> {{ flight_info['airplane_ID'] }} </td>
						<td> {{ flight_info['departure_airport'] }} </td>
						<td> {{ flight_info['departure_date'] }} </td>
						<td> {{ flight_info['departure_time'] }} </td>
						<td> {{ flight_info['arrival_airport'] }} </td>
						<td> {{ flight_info['arrival_date'] }} </td>
						<td> {{ flight_info['arrival_time'] }} </td>
						<td>
							<form action="/customerHome" method="POST">
								<button type="submit" name="flight_to_rate" value={{ flight['flight_num'] }}> Yes </button>
							</form>
						</td>
					<tr>

					{% endif %}
					
				{% endfor %}	

			{% endfor %}

			</tr>

		</table>



		<h2> View My Future Flights</h2>

		<table>

			<tr>
				<td> Flight Number </td>
				<td> Ticket ID </td>
				<td> Airline Name </td>
				<td> Airplane ID </td>
				<td> Departure Airport </td>
				<td> Departure Date </td>
				<td> Departure Time </td>
				<td> Arrival Airport </td>
				<td> Arrival Date </td>
				<td> Arrival Time </td>
				<td> Flight Status </td>
			</tr>

			<tr>

			{% for flight in all_flights %}

				{% for flight_info in future_flights_info %}

					{% if flight['flight_num'] == flight_info['flight_num'] %}

					<tr>
						<td> {{ flight['flight_num'] }} </td>
						<td> {{ flight['ticket_ID'] }} </td>
						<td> {{ flight_info['airline_name'] }} </td>
						<td> {{ flight_info['airplane_ID'] }} </td>
						<td> {{ flight_info['departure_airport'] }} </td>
						<td> {{ flight_info['departure_date'] }} </td>
						<td> {{ flight_info['departure_time'] }} </td>
						<td> {{ flight_info['arrival_airport'] }} </td>
						<td> {{ flight_info['arrival_date'] }} </td>
						<td> {{ flight_info['arrival_time'] }} </td>
						<td> {{ flight_info['flight_status'] }} </td>
					<tr>

					{% endif %}
					
				{% endfor %}	

			{% endfor %}

			</tr>

		</table>



		<h2> Search for Flights </h2>

		<form action="/customerHome" method="POST">
			Flight Package:
			<select name="package" required>
				<option value="select"> Select </option>
				<option value="One Way"> One Way </option>
				<option value="Round Trip"> Round Trip </option>
			</select>

			Departure City:
			<select name="source" required>
				<option value="select"> Select </option>
				<option value="JFK"> New York / JFK </option>
				<option value="PVG"> Shanghai / PVG </option>
			</select>

			Destination City:
			<select name="destination" required>
				<option value="select"> Select </option>
				<option value="JFK"> New York / JFK </option>
				<option value="PVG"> Shanghai / PVG </option>
			</select>

			Departure Date:
			<input type="date" min="2021-04-19" name="departure" required>

			Arrival Date:
			<input type="date" min="2021-04-19" name="arrival" required>

			<input type="submit" value=Search />
			
		</form>

		{% if query_flights %}

		<table>

			<tr>
				<td> Flight Number </td>
				<td> Airline Name </td>
				<td> Airplane ID </td>
				<td> Departure Airport </td>
				<td> Departure Date </td>
				<td> Departure Time </td>
				<td> Arrival Airport </td>
				<td> Arrival Date </td>
				<td> Arrival Time </td>
				<td> Price </td>
				<td> Flight Status </td>
				<td> Check Availability? </td>
			</tr>

			{% for flight in query_flights %}

			<tr>
				<td> {{ flight['flight_num'] }} </td>
				<td> {{ flight['airline_name'] }} </td>
				<td> {{ flight['airplane_ID'] }} </td>
				<td> {{ flight['departure_airport'] }} </td>
				<td> {{ flight['departure_date'] }} </td>
				<td> {{ flight['departure_time'] }} </td>
				<td> {{ flight['arrival_airport'] }} </td>
				<td> {{ flight['arrival_date'] }} </td>
				<td> {{ flight['arrival_time'] }} </td>
				<td> {{ flight['base_price'] }} </td>	
				<td> {{ flight['flight_status'] }} </td>
				<td>
					<form action="/customerHome" method="POST">
						<button type="submit" name="flight_select" value= {{ flight['flight_num'] }} > Yes </button>
					<form>

				</td>	
			</tr>

			{% endfor %}	

		</table>

		{% endif %}

		

		{% if tickets and tickets != "No Tickets" %}

			<h2> Purchase Tickets </h2>
			<!-- <h3 style="color: green"> Tickets are Available for Flight: {{flight_select}}. Complete Your Purchase Below </h3> -->
			
			<form action="/customerHome" method="POST">
				Flight:
				<select name="flight_purchase" required>
					<option value= {{ flight_select }} > {{ flight_select }} </option>
				</select>
				
				</br> </br>

				Tickets (Select One or Multiple):
				{% for ticket in tickets%}
					<input type="checkbox" name="ticket" value= {{ ticket['ticket_ID'] }} />
					TN-{{ ticket['ticket_ID'] }}
				{% endfor %}

				</br> </br>

				Card Type:
				<input type="text" name="type" placeholder="Card Type" required/>

				Card Number:
				<input type="text" name="num" placeholder="Card Number" required/>

				Card Security Code:
				<input type="text" name="security" placeholder="Security Code" required/>

				Card Name:
				<input type="text" name="name" placeholder="Card Name" required/>
				
				Card Expiration Date:
				<input type="date" min="2021-04-17" name="exp" placeholder="Card Expiration Date" required/> </br>  </br>

				<input type="submit" value="Purchase Ticket" />
			<form>

		{% elif tickets == "No Tickets" %}

			<h3 style="color: red"> No Tickets Avaiable for Flight: {{flight_select}} </h3>

		{% endif %}

		

		{% if purchase == "Complete" %}

			<h2> Purchase Tickets </h2>
			<h3 style="color: green"> Purchase Complete </h3>

		{% endif %}

		{% if flight_to_rate %}

			<h2> Review Previously Taken Flights  </h2>

			<form action="/customerHome" method="POST">
				Flight:
				<select name="flight_rated" required>
					<option value= {{ flight_to_rate }} > {{flight_to_rate}} </option>
				</select>
			
				Rating:
				<select name="rating" required>
					<option value="5"> 5 Stars </option>
					<option value="4"> 4 Stars </option>
					<option value="3"> 3 Stars </option>
					<option value="2"> 2 Stars </option>
					<option value="1"> 1 Star </option>
				</select> </br> </br>

				Comment: </br>
				<textarea name="comment" rows="6" cols="30"> </textarea> </br> </br>
				<input type="submit" value="Submit" />
			</form>

		{% endif %}

		{% if review == "Complete" %}
			<h2> Review Previously Taken Flights </h2>
			<h3 style="color: green"> Review Complete </h3>
		{% elif review == "Already Complete"%}
			<h2> Review Previously Taken Flights </h2>
			<h3 style="color: green"> You Have Already Reviewed Flight: {{flight_rated}}</h3>
		{% endif %}

		<h2> Track My Spending </h2>

		<a href="/logout">Logout</a>

	</body>

</html>
