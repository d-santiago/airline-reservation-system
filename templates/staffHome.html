<!DOCTYPE html>
<html>
	<head>
		<link type="text/css" rel="stylesheet" href="{{ url_for('static', filename='styles/styles.css') }}">
	</head>

	<body>

		<h1>Welcome, {{username}}</h1>

		<h2> Past Flights (Past 30 Days)</h2>

		<table>

			<tr>
				<td> Flight Number </td>
				<td> Airline Name </td>
				<td> Airplane ID </td>
				<td> Departure Airport </td>
				<td> Departure Date </td>
				<td> Departure Time </td>
				<td> Arrival Airport </td>
				<td> Arrival Date </td>
				<td> Arrival Time </td>
				<td> Trip Type </td>
			</tr>

			{% for flight in past_flights %}

				<tr>
					<td> {{ flight['flight_num'] }} </td>
					<td> {{ flight['airline_name'] }} </td>
					<td> {{ flight['airplane_ID'] }} </td>
					<td> {{ flight['departure_airport'] }} </td>
					<td> {{ flight['departure_date'] }} </td>
					<td> {{ flight['departure_time'] }} </td>
					<td> {{ flight['arrival_airport'] }} </td>
					<td> {{ flight['arrival_date'] }} </td>
					<td> {{ flight['arrival_time'] }} </td>
					<td> {{ flight['trip_type'] }} </td>
				<tr>

			{% endfor %}

		</table>

		<h2> Future Flights (Next 30 Days)</h2>

		<table>

			<tr>
				<td> Flight Number </td>
				<td> Airline Name </td>
				<td> Airplane ID </td>
				<td> Departure Airport </td>
				<td> Departure Date </td>
				<td> Departure Time </td>
				<td> Arrival Airport </td>
				<td> Arrival Date </td>
				<td> Arrival Time </td>
				<td> Trip Type </td>
				<td> Flight Status </td>
				<td> Change Flight Status </td>

			</tr>

			{% for flight in future_flights %}

				<tr>
					<td> {{ flight['flight_num'] }} </td>
					<td> {{ flight['airline_name'] }} </td>
					<td> {{ flight['airplane_ID'] }} </td>
					<td> {{ flight['departure_airport'] }} </td>
					<td> {{ flight['departure_date'] }} </td>
					<td> {{ flight['departure_time'] }} </td>
					<td> {{ flight['arrival_airport'] }} </td>
					<td> {{ flight['arrival_date'] }} </td>
					<td> {{ flight['arrival_time'] }} </td>
					<td> {{ flight['trip_type'] }} </td>
					<td> {{ flight['flight_status'] }} </td>
					<td>
						<form action="/staffHome" method="POST">

							<select name="flight_select" value={{ flight['flight_num'] }} required>
								<option value={{ flight['flight_num'] }}> {{ flight['flight_num'] }} </option>
							</select>

							<select name="flight_status" required>
								{% if flight['flight_status'] == "On Time" %}
									<option value="Delayed"> Delayed</option>
								{% else %}
									<option value="On Time"> On Time </option>
								{% endif %}
							</select>

							<input type="submit" value="Change Flight Status" />

						</form>
					</td>	
				<tr>

			{% endfor %}

		</table>



		<h2> Search for Flights </h2>

		<form action="/staffHome" method="POST">

			Trip Type:
			<select name="trip_type" required>
				<option value="select"> Select </option>
				<option value="One Way"> One Way </option>
				<option value="Round Trip"> Round Trip </option>
			</select>

			Departure City:
			<select name="source" required>
				<option value="select"> Select </option>
				<option value="JFK"> New York / JFK </option>
				<option value="PVG"> Shanghai / PVG </option>
			</select>

			Destination City:
			<select name="destination" required>
				<option value="select"> Select </option>
				<option value="JFK"> New York / JFK </option>
				<option value="PVG"> Shanghai / PVG </option>
			</select>

			Departure Date:
			<input type="date" name="departure" required>

			Arrival Date:
			<input type="date" name="arrival" required>

			<input type="submit" value=Search />
			
		</form>

		<!-- Displays the flights generated from the 'Search for and Purchase Flights' form -->
		{% if query_flights and query_flights != "No Results" %}
		
			</br>
			<table>

				<tr>
					<td> Flight Number </td>
					<td> Airline Name </td>
					<td> Airplane ID </td>
					<td> Departure Airport </td>
					<td> Departure Date </td>
					<td> Departure Time </td>
					<td> Arrival Airport </td>
					<td> Arrival Date </td>
					<td> Arrival Time </td>
					<td> Trip Type </td>
					<td> Price </td>
					<td> Flight Status </td>
					<td> View Customers </td>
					<td> View Ratings and Reviews </td>
				</tr>

			{% for flight in query_flights %}

				<tr>
					<td> {{ flight['flight_num'] }} </td>
					<td> {{ flight['airline_name'] }} </td>
					<td> {{ flight['airplane_ID'] }} </td>
					<td> {{ flight['departure_airport'] }} </td>
					<td> {{ flight['departure_date'] }} </td>
					<td> {{ flight['departure_time'] }} </td>
					<td> {{ flight['arrival_airport'] }} </td>
					<td> {{ flight['arrival_date'] }} </td>
					<td> {{ flight['arrival_time'] }} </td>
					<td> {{ flight['trip_type'] }} </td>	
					<td> {{ flight['base_price'] }} </td>	
					<td> {{ flight['flight_status'] }} </td>
					<td>
						<form action="/staffHome" method="POST">
							<button type="submit" name="customer_flight_select" value= {{ flight['flight_num'] }} > Yes </button>
						</form>
					</td>
					<td>
						<form action="/staffHome" method="POST">
							<button type="submit" name="review_flight_select" value= {{ flight['flight_num'] }} > Yes </button>
						</form>
					</td>		
				</tr>

			{% endfor %}	

		</table> </br>

		{% elif query_flights == "No Results" %}

			<h4 style="color: red"> {{ query_flights }}</h4>

		{% endif %}

		{% if customers and customers != "No Results" %}
			
			</br>
			<table>
				
				<tr>
					<td> Flight Number </td>
					<td> Customer Email </td>
				</tr>

			{% for customer in customers%}

				<tr>
					<td> {{ customer_flight_select }} </td>
					<td> {{ customer['cus_email'] }} </td>
				</tr>

			{% endfor %}

			</table>

		{% elif customers == "No Results" %}

			<h4 style="color: red"> {{ customers }}</h4>

		{% endif %}

		{% if reviews and reviews != "No Reviews" %}

			<h4 style="color: green"> Average Rating: {{ avg_rating }} </h4>
			
			</br>
			<table>
				<tr>
					<td> Customer Email </td>
					<td> Rating </td>
					<td> Review </td>

				</tr>

			{% for review in reviews %}

				<tr>
					<td> {{ review['cus_email'] }} </td>
					<td> {{ review['rating'] }} </td>
					<td> {{ review['comment'] }} </td>
				</tr>

			{% endfor %}

			</table>

		{% elif reviews == "No Reviews" %}

			<h4 style="color: red"> {{ reviews }} </h4>

		{% endif %}
		


		</br> <hr>

		<h2> Add New Flight </h2>

			<form action="/staffHome" method="POST">
				
				Airlplane ID:
				<select name="airplane_ID" required>
					<option value="select"> Select </option>
					{% for airplane in airplanes %}
						<option value={{ airplane['airplane_ID'] }}> {{ airplane['airplane_ID'] }} </option>
					{% endfor %}
				</select>

				Trip Type:
				<select name="trip_type" required>
					<option value="select"> Select </option>
					<option value="One Way"> One Way </option>
					<option value="Round Trip"> Round Trip </option>
				</select> </br> </br>

				Departure Airport:
				<select name="departure_airport" required>
					<option value="select"> Select </option>
					<option value="JFK"> New York / JFK </option>
					<option value="PVG"> Shanghai / PVG </option>
				</select>

				Departure Date: <input type="date" name="departure_date" placeholder="Departure Date" required/>
				Departure Time: <input type="time" name="departure_time" placeholder="Departure Time" required/> </br> </br>

				Arrival Airport:
				<select name="arrival_airport" required>
					<option value="select"> Select </option>
					<option value="JFK"> New York / JFK </option>
					<option value="PVG"> Shanghai / PVG </option>
				</select>

				Arrival Date: <input type="date" name="arrival_date" placeholder="Arrival Date" required/>
				Arrival Time: <input type="time" name="arrival_time" placeholder="Arrivale Time" required/> </br> </br>
				Base Price: <input type="text" name="base_price" placeholder="Base Price" required/> </br> </br>

				Flight Status:
				<select name="flight_status" required>
					<option value="select"> Select </option>
					<option value="On Time"> On Time </option>
					<option value="Delayed"> Delayed</option>
				</select> </br> </br>	

				<input type="submit" value="Add Flight" />

			</form>



		</br> <hr>

		<h2> Add New Airplane </h2>

			<form action="/staffHome" method="POST">

				Seats: <input type="text" name="seats" placeholder="Seats" required/>
				<input type="submit" value="Add Airplane" />

			</form>
		


		</br> <hr>

		<h2> Add New Airport </h2>

		<form action="/staffHome" method="POST">

			Airport Name: <input type="text" name="airport_name" placeholder="Airport Name" required/>
			City: <input type="text" name="city" placeholder="City" required/>
			<input type="submit" value="Add Airport" />

		</form>



		</br> <hr>

		<h2> View Top Booking Agents </h2>

		<h3> Top 5 Booking Agents: Based on Ticket Sales Within the Last Month </h3>
		
		{% if top_agents_month %}

			<table>

				<tr>
					<td> Booking Agent ID </td>
					<td> Tickets Sold </td>
				</tr>

				{% for agent in top_agents_month %}

				<tr>
					<td> {{ agent['agent_ID'] }} </td>
					<td> {{ agent['purchases'] }} </td>
				</tr>

				{% endfor %}	

			</table>
			
		{% endif %}

		<h3> Top 5 Booking Agents: Based on Ticket Sales Within the Last Year </h3>

		{% if top_agents_year %}

			<table>

				<tr>
					<td> Booking Agent ID </td>
					<td> Tickets Sold </td>
				</tr>

				{% for agent in top_agents_year %}

				<tr>
					<td> {{ agent['agent_ID'] }} </td>
					<td> {{ agent['purchases'] }} </td>
				</tr>

				{% endfor %}	

			</table>
			
		{% endif %}
		
		<h3> Top 5 Booking Agents: Based on Commission Within the Last Year </h3>

		{% if top_agents_commission%}

			<table>

				<tr>
					<td> Booking Agent ID </td>
					<td> Commission </td>
				</tr>

				{% for agent in top_agents_commission %}

				<tr>
					<td> {{ agent['agent_ID'] }} </td>
					<td> ${{ agent['commission'] }}0 </td>
				</tr>

				{% endfor %}	

			</table>
			
		{% endif %}



		</br> <hr>

		<h2> View Top Customer Within the Past Year </h2>

		<table>

			<tr>
				<td> Customer Email </td>
				<td> Tickets Purchased </td>
			</tr>

			<tr>
				<td> {{ top_customer['cus_email'] }} </td>
				<td> {{ top_customer['purchases'] }} </td>
			</tr>

		</table>



		</br> <hr>

		<h2> Find Customer Flights </h2>

		<form action="/staffHome" method="POST">

			Customer Email: <input type="text" name="cus_email" placeholder="Customer Email" required/>
			<input type="submit" value="Find Customer's Flights" />

		</form>

		{% if customer_flights and customer_flights != "No Results" %}
			
			</br>
			<table>
				<tr>
					<td> Flight Number </td>
				</tr>

			{% for flight in customer_flights %}

				<tr>
					<td> {{ flight['flight_num'] }} </td>
				</tr>

			{% endfor %}

			</table>

		{% elif customer_flights == "No Results" %}

			<h4 style="color: red"> {{ customer_flights }} </h4>

		{% endif %}



		</br> <hr>

		<h2> View Tickets Sold </h2>

		{% if tickets_sold_month and tickets_sold_month != "No Tickets Sold" %}
			
			<h4> {{ tickets_sold_month}} Tickets Were Sold In the Past Month </h4>

		{% elif tickets_sold_month == "No Tickets Sold" %}

			<h4 style="color: red"> {{ tickets_sold_month }} In the Past Month </h4>

		{% endif %}

		{% if tickets_sold_year and tickets_sold_year != "No Tickets Sold" %}
			
			<h4> {{ tickets_sold_year }} Tickets Were Sold In the Past Year </h4>

		{% elif tickets_sold_year == "No Tickets Sold" %}

			<h4 style="color: red"> {{ tickets_sold_year }} In the Past Year </h4>

		{% endif %}

		<form action="/staffHome" method="POST">

			Start Date: <input type="date" name="ticket_start_date" placeholder="Start Date" required/>
			End Date: <input type="date" name="ticket_end_date" placeholder="End Date" required/>
			<input type="submit" value="Find Tickets Sold" />

		</form>

		{% if tickets_sold and tickets_sold != "No Tickets Sold" %}

			<h4> {{ tickets_sold}} were sold between {{ ticket_start_date }} and {{ ticket_end_date }} </h4>

		{% elif tickets_sold == "No Tickets Sold" %}

			<h4> {{ tickets_sold }} between {{ ticket_start_date }} and {{ ticket_end_date }} </h4>

		{% endif %}


		</br> <hr>

		<h2> View Revenue Earned </h2>

		<h3> Within the Past Month </h3>

		{% if direct_revenue_month and direct_revenue_month != "No Direct Revenue" %}

			<h4> Direct Revenue: ${{ direct_revenue_month }}0 </h4>

		{% elif direct_revenue_month == "No Direct Revenue" %}

			<h4> Direct Revenue: $0.00 </h4>

		{% endif %}

		{% if indirect_revenue_month and indirect_revenue_month != "No Indirect Revenue" %}

			<h4> Indirect Revenue: ${{ indirect_revenue_month }}0 </h4>

		{% elif indirect_revenue_month == "No Indirect Revenue" %}

			<h4> Indirect Revenue: $0.00 </h4>

		{% endif %}

		

		<h3> Within the Past Year </h3>


		{% if indirect_revenue_year and indirect_revenue_year != "No Indirect Revenue" %}

			<h4> Indirect Revenue: ${{ indirect_revenue_year }}0 </h4>

		{% elif indirect_revenue_year == "No Indirect Revenue" %}

			<h4> Indirect Revenue: $0.00 </h4>

		{% endif %}

		{% if indirect_revenue_year and indirect_revenue_year != "No Indirect Revenue" %}

			<h4> Indirect Revenue: ${{ indirect_revenue_year }}0 </h4>

		{% elif indirect_revenue_year == "No Indirect Revenue" %}

			<h4> Indirect Revenue: $0.00 </h4>

		{% endif %}



		<hr>

		<h2> View Top 3 Destinations </h2>

		<h3> Within the Past Month </h3>

		{% if top_destinations_month %}

			<table>

				<tr>
					<td> Destination </td>
					<td> Tickets Sold </td>
				</tr>

				{% for destination in top_destinations_month %}

				<tr>
					<td> {{ destination['arrival_airport'] }} </td>
					<td> {{ destination['tickets'] }} </td>
				</tr>

				{% endfor %}	

			</table>
			
		{% endif %}

		<h3> Within the Past Year </h3>

		{% if top_destinations_year %}

			<table>

				<tr>
					<td> Destination </td>
					<td> Tickets Sold </td>
				</tr>

				{% for destination in top_destinations_year %}

				<tr>
					<td> {{ destination['arrival_airport'] }} </td>
					<td> {{ destination['tickets'] }} </td>
				</tr>

				{% endfor %}	

			</table>
			
		{% endif %}

		</br> <hr>

		<a href="/staffLogout">Logout</a>

	</body>

</html>
